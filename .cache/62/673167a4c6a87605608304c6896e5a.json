{"id":"pw7F","dependencies":[{"name":"/Users/gabriel/Documents/paymentelys/package.json","includedInParent":true,"mtime":1630498634517},{"name":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/package.json","includedInParent":true,"mtime":1629877547165},{"name":"web3-core-helpers","loc":{"line":25,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-helpers/lib/index.js"},{"name":"web3-utils","loc":{"line":26,"column":20},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-utils/lib/index.js"},{"name":"web3-core-promievent","loc":{"line":27,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-promievent/lib/index.js"},{"name":"web3-core-subscriptions","loc":{"line":28,"column":28},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/index.js"},{"name":"@ethersproject/transactions","loc":{"line":29,"column":37},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/@ethersproject/transactions/lib.esm/index.js"}],"generated":{"js":"\"use strict\";var t=require(\"web3-core-helpers\").errors,e=require(\"web3-core-helpers\").formatters,r=require(\"web3-utils\"),a=require(\"web3-core-promievent\"),n=require(\"web3-core-subscriptions\").subscriptions,o=require(\"@ethersproject/transactions\"),i=function(t){if(!t.call||!t.name)throw new Error('When creating a method you need to provide at least the \"name\" and \"call\" property.');this.name=t.name,this.call=t.call,this.params=t.params||0,this.inputFormatter=t.inputFormatter,this.outputFormatter=t.outputFormatter,this.transformPayload=t.transformPayload,this.extraFormatters=t.extraFormatters,this.abiCoder=t.abiCoder,this.requestManager=t.requestManager,this.accounts=t.accounts,this.defaultBlock=t.defaultBlock||\"latest\",this.defaultAccount=t.defaultAccount||null,this.transactionBlockTimeout=t.transactionBlockTimeout||50,this.transactionConfirmationBlocks=t.transactionConfirmationBlocks||24,this.transactionPollingTimeout=t.transactionPollingTimeout||750,this.defaultCommon=t.defaultCommon,this.defaultChain=t.defaultChain,this.defaultHardfork=t.defaultHardfork,this.handleRevert=t.handleRevert};i.prototype.setRequestManager=function(t,e){this.requestManager=t,e&&(this.accounts=e)},i.prototype.createFunction=function(t,e){var r=this.buildCall();return r.call=this.call,this.setRequestManager(t||this.requestManager,e||this.accounts),r},i.prototype.attachToObject=function(t){var e=this.buildCall();e.call=this.call;var r=this.name.split(\".\");r.length>1?(t[r[0]]=t[r[0]]||{},t[r[0]][r[1]]=e):t[r[0]]=e},i.prototype.getCall=function(t){return\"function\"==typeof this.call?this.call(t):this.call},i.prototype.extractCallback=function(t){if(\"function\"==typeof t[t.length-1])return t.pop()},i.prototype.validateArgs=function(e){if(e.length!==this.params)throw t.InvalidNumberOfParams(e.length,this.params,this.name)},i.prototype.formatInput=function(t){var e=this;return this.inputFormatter?this.inputFormatter.map(function(r,a){return r?r.call(e,t[a]):t[a]}):t},i.prototype.formatOutput=function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.outputFormatter&&t?e.outputFormatter(t):t}):this.outputFormatter&&t?this.outputFormatter(t):t},i.prototype.toPayload=function(t){var e=this.getCall(t),r=this.extractCallback(t),a=this.formatInput(t);this.validateArgs(a);var n={method:e,params:a,callback:r};return this.transformPayload&&(n=this.transformPayload(n)),n},i.prototype._confirmTransaction=function(s,c,u){var l=this,m=!1,p=!0,h=0,f=0,d=null,v=null,g=u.params[0]&&\"object\"==typeof u.params[0]&&u.params[0].gas?u.params[0].gas:null,b=!!u.params[0]&&\"object\"==typeof u.params[0]&&u.params[0].data&&u.params[0].from&&!u.params[0].to,y=b&&u.params[0].data.length>2,F=[new i({name:\"getBlockByNumber\",call:\"eth_getBlockByNumber\",params:2,inputFormatter:[e.inputBlockNumberFormatter,function(t){return!!t}],outputFormatter:e.outputBlockFormatter}),new i({name:\"getTransactionReceipt\",call:\"eth_getTransactionReceipt\",params:1,inputFormatter:[null],outputFormatter:e.outputTransactionReceiptFormatter}),new i({name:\"getCode\",call:\"eth_getCode\",params:2,inputFormatter:[e.inputAddressFormatter,e.inputDefaultBlockNumberFormatter]}),new i({name:\"getTransactionByHash\",call:\"eth_getTransactionByHash\",params:1,inputFormatter:[null],outputFormatter:e.outputTransactionFormatter}),new n({name:\"subscribe\",type:\"eth\",subscriptions:{newBlockHeaders:{subscriptionName:\"newHeads\",params:0,outputFormatter:e.outputBlockFormatter}}})],E={};F.forEach(t=>{t.attachToObject(E),t.requestManager=l.requestManager});var w=function(n,i,F,w,P){if(!F)return P||(P={unsubscribe:function(){clearInterval(d)}}),(n?a.resolve(n):E.getTransactionReceipt(c)).catch(function(t){P.unsubscribe(),m=!0,r._fireError({message:\"Failed to check for transaction receipt:\",data:t},s.eventEmitter,s.reject)}).then(async function(t){if(!t||!t.blockHash)throw new Error(\"Receipt missing or blockHash null\");if(l.extraFormatters&&l.extraFormatters.receiptFormatter&&(t=l.extraFormatters.receiptFormatter(t)),s.eventEmitter.listeners(\"confirmation\").length>0){var e;if(void 0===n||0!==f){var r=await E.getBlockByNumber(\"latest\"),a=r?r.hash:null;i?v?(e=await E.getBlockByNumber(v.number+1))&&(v=e,s.eventEmitter.emit(\"confirmation\",f,t,a)):(e=await E.getBlockByNumber(t.blockNumber),v=e,s.eventEmitter.emit(\"confirmation\",f,t,a)):s.eventEmitter.emit(\"confirmation\",f,t,a)}(i&&e||!i)&&f++,p=!1,f===l.transactionConfirmationBlocks+1&&(P.unsubscribe(),s.eventEmitter.removeAllListeners())}return t}).then(async function(e){if(b&&!m){if(!e.contractAddress)return p&&(P.unsubscribe(),m=!0),void r._fireError(t.NoContractAddressFoundError(e),s.eventEmitter,s.reject,null,e);var a;try{a=await E.getCode(e.contractAddress)}catch(F){}if(!a)return;!0===e.status&&y||a.length>2?(s.eventEmitter.emit(\"receipt\",e),l.extraFormatters&&l.extraFormatters.contractDeployFormatter?s.resolve(l.extraFormatters.contractDeployFormatter(e)):s.resolve(e),p&&s.eventEmitter.removeAllListeners()):r._fireError(t.ContractCodeNotStoredError(e),s.eventEmitter,s.reject,null,e),p&&P.unsubscribe(),m=!0}return e}).then(async function(a){if(!b&&!m){if(a.outOfGas||g&&g===a.gasUsed||!0!==a.status&&\"0x1\"!==a.status&&void 0!==a.status)if(JSON.stringify(a,null,2),!1===a.status||\"0x0\"===a.status)try{var n=null;if(!l.handleRevert||\"eth_sendTransaction\"!==l.call&&\"eth_sendRawTransaction\"!==l.call)throw!1;var i=u.params[0];if(\"eth_sendRawTransaction\"===l.call){var c=u.params[0],h=o.parse(c);i=e.inputTransactionFormatter({data:h.data,to:h.to,from:h.from,gas:h.gasLimit.toHexString(),gasPrice:h.gasPrice.toHexString(),value:h.value.toHexString()})}if(!(n=await l.getRevertReason(i,a.blockNumber)))throw!1;r._fireError(t.TransactionRevertInstructionError(n.reason,n.signature,a),s.eventEmitter,s.reject,null,a)}catch(f){r._fireError(t.TransactionRevertedWithoutReasonError(a),s.eventEmitter,s.reject,null,a)}else r._fireError(t.TransactionOutOfGasError(a),s.eventEmitter,s.reject,null,a);else s.eventEmitter.emit(\"receipt\",a),s.resolve(a),p&&s.eventEmitter.removeAllListeners();p&&P.unsubscribe(),m=!0}}).catch(function(){h++,i?h-1>=l.transactionPollingTimeout&&(P.unsubscribe(),m=!0,r._fireError(t.TransactionError(\"Transaction was not mined within \"+l.transactionPollingTimeout+\" seconds, please make sure your transaction was properly sent. Be aware that it might still be mined!\"),s.eventEmitter,s.reject)):h-1>=l.transactionBlockTimeout&&(P.unsubscribe(),m=!0,r._fireError(t.TransactionError(\"Transaction was not mined within \"+l.transactionBlockTimeout+\" blocks, please make sure your transaction was properly sent. Be aware that it might still be mined!\"),s.eventEmitter,s.reject))});P.unsubscribe(),m=!0,r._fireError({message:\"Failed to subscribe to new newBlockHeaders to confirm the transaction receipts.\",data:F},s.eventEmitter,s.reject)},P=function(t){const e=()=>{d=setInterval(w.bind(null,t,!0),1e3)};this.requestManager.provider.on?E.subscribe(\"newBlockHeaders\",function(r,a,n){r||!a?e():w(t,!1,r,0,n)}):e()}.bind(this);E.getTransactionReceipt(c).then(function(t){t&&t.blockHash?(s.eventEmitter.listeners(\"confirmation\").length>0&&P(t),w(t,!1)):m||P()}).catch(function(){m||P()})};var s=function(t,e){return\"number\"==typeof t?e.wallet[t]:t&&\"object\"==typeof t&&t.address&&t.privateKey?t:e.wallet[t.toLowerCase()]};function c(t,e){return new Promise((a,n)=>{try{var o=new i({name:\"getBlockByNumber\",call:\"eth_getBlockByNumber\",params:2,inputFormatter:[function(t){return t?r.toHex(t):\"latest\"},function(){return!1}]}).createFunction(t.requestManager),s=new i({name:\"getGasPrice\",call:\"eth_gasPrice\",params:0}).createFunction(t.requestManager);Promise.all([o(),s()]).then(t=>{const[n,o]=t;if(n&&n.baseFeePerGas){let t,o;e.gasPrice?(t=e.gasPrice,o=e.gasPrice,delete e.gasPrice):(t=e.maxPriorityFeePerGas||\"0x3B9ACA00\",o=e.maxFeePerGas||r.toHex(r.toBN(n.baseFeePerGas).mul(r.toBN(2)).add(r.toBN(t)))),a({maxFeePerGas:o,maxPriorityFeePerGas:t})}else{if(e.maxPriorityFeePerGas||e.maxFeePerGas)throw Error(\"Network doesn't support eip-1559\");a({gasPrice:o})}})}catch(c){n(c)}})}i.prototype.buildCall=function(){var e=this,n=\"eth_sendTransaction\"===e.call||\"eth_sendRawTransaction\"===e.call,o=\"eth_call\"===e.call,i=function(){var i=a(!n),u=e.toPayload(Array.prototype.slice.call(arguments)),l=function(a,s){var c;if(e.handleRevert&&o&&e.abiCoder&&(!a&&e.isRevertReasonString(s)?c=s.substring(10):a&&a.data&&(c=a.data.substring(10)),c)){var l=e.abiCoder.decodeParameter(\"string\",\"0x\"+c);return void r._fireError(t.RevertInstructionError(l,\"Error(String)\"),i.eventEmitter,i.reject,u.callback,{reason:l,signature:\"Error(String)\"})}try{s=e.formatOutput(s)}catch(m){a=m}if(s instanceof Error&&(a=s),a)return a.error&&(a=a.error),r._fireError(a,i.eventEmitter,i.reject,u.callback);u.callback&&u.callback(null,s),n?(i.eventEmitter.emit(\"transactionHash\",s),e._confirmTransaction(i,s,u)):a||i.resolve(s)},m=function(t){var r={...u,method:\"eth_sendRawTransaction\",params:[t.rawTransaction]};e.requestManager.send(r,l)},p=function(t,e){var r;if(e&&e.accounts&&e.accounts.wallet&&e.accounts.wallet.length)if(\"eth_sendTransaction\"===t.method){var a=t.params[0];if((r=s(a&&\"object\"==typeof a?a.from:null,e.accounts))&&r.privateKey)return delete(a=JSON.parse(JSON.stringify(a))).from,e.defaultChain&&!a.chain&&(a.chain=e.defaultChain),e.defaultHardfork&&!a.hardfork&&(a.hardfork=e.defaultHardfork),e.defaultCommon&&!a.common&&(a.common=e.defaultCommon),void e.accounts.signTransaction(a,r.privateKey).then(m).catch(function(t){if(\"function\"==typeof i.eventEmitter.listeners&&i.eventEmitter.listeners(\"error\").length){try{i.eventEmitter.emit(\"error\",t)}catch(t){}i.eventEmitter.removeAllListeners(),i.eventEmitter.catch(function(){})}i.reject(t)})}else if(\"eth_sign\"===t.method){var n=t.params[1];if((r=s(t.params[0],e.accounts))&&r.privateKey){var o=e.accounts.sign(n,r.privateKey);return t.callback&&t.callback(null,o.signature),void i.resolve(o.signature)}}return e.requestManager.send(t,l)};return n&&u.params[0]&&\"object\"==typeof u.params[0]&&void 0===u.params[0].gasPrice&&(void 0===u.params[0].maxPriorityFeePerGas||void 0===u.params[0].maxFeePerGas)?c(e,u.params[0]).then(t=>{void 0!==t.gasPrice?u.params[0].gasPrice=t.gasPrice:void 0!==t.maxPriorityFeePerGas&&void 0!==t.maxFeePerGas&&(u.params[0].maxPriorityFeePerGas=t.maxPriorityFeePerGas,u.params[0].maxFeePerGas=t.maxFeePerGas),n&&setTimeout(()=>{i.eventEmitter.emit(\"sending\",u)},0),p(u,e)}):(n&&setTimeout(()=>{i.eventEmitter.emit(\"sending\",u)},0),p(u,e)),n&&setTimeout(()=>{i.eventEmitter.emit(\"sent\",u)},0),i.eventEmitter};return i.method=e,i.request=this.request.bind(this),i},i.prototype.getRevertReason=function(t,e){var a=this;return new Promise(function(n,o){new i({name:\"call\",call:\"eth_call\",params:2,abiCoder:a.abiCoder,handleRevert:!0}).createFunction(a.requestManager)(t,r.numberToHex(e)).then(function(){n(!1)}).catch(function(t){t.reason?n({reason:t.reason,signature:t.signature}):o(t)})})},i.prototype.isRevertReasonString=function(t){return\"string\"==typeof t&&(t.length-2)/2%32==4&&\"0x08c379a0\"===t.substring(0,10)},i.prototype.request=function(){var t=this.toPayload(Array.prototype.slice.call(arguments));return t.format=this.formatOutput.bind(this),t},module.exports=i;"},"sourceMaps":null,"error":null,"hash":"a1a0556da088ff05e8c4067fabfccca5","cacheData":{"env":{}}}