{"id":"pw7F","dependencies":[{"name":"/Users/gabriel/Documents/paymentelys/package.json","includedInParent":true,"mtime":1629880755799},{"name":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/package.json","includedInParent":true,"mtime":1629877547165},{"name":"web3-core-helpers","loc":{"line":25,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-helpers/lib/index.js"},{"name":"web3-utils","loc":{"line":26,"column":20},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-utils/lib/index.js"},{"name":"web3-core-promievent","loc":{"line":27,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-promievent/lib/index.js"},{"name":"web3-core-subscriptions","loc":{"line":28,"column":28},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/index.js"},{"name":"@ethersproject/transactions","loc":{"line":29,"column":37},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-method/lib/index.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/@ethersproject/transactions/lib.esm/index.js"}],"generated":{"js":"\"use strict\";function t(t,a){return o(t)||n(t,a)||r(t,a)||e()}function e(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function r(t,e){if(t){if(\"string\"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===r&&t.constructor&&(r=t.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(t):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function n(t,e){var r=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=r){var a,n,o=[],i=!0,s=!1;try{for(r=r.call(t);!(i=(a=r.next()).done)&&(o.push(a.value),!e||o.length!==e);i=!0);}catch(c){s=!0,n=c}finally{try{i||null==r.return||r.return()}finally{if(s)throw n}}return o}}function o(t){if(Array.isArray(t))return t}function i(t,e,r,a,n,o,i){try{var s=t[o](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(a,n)}function s(t){return function(){var e=this,r=arguments;return new Promise(function(a,n){var o=t.apply(e,r);function s(t){i(o,a,n,s,c,\"next\",t)}function c(t){i(o,a,n,s,c,\"throw\",t)}s(void 0)})}}function c(t){return(c=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}var u=require(\"web3-core-helpers\").errors,l=require(\"web3-core-helpers\").formatters,m=require(\"web3-utils\"),f=require(\"web3-core-promievent\"),p=require(\"web3-core-subscriptions\").subscriptions,h=require(\"@ethersproject/transactions\"),d=function(t){if(!t.call||!t.name)throw new Error('When creating a method you need to provide at least the \"name\" and \"call\" property.');this.name=t.name,this.call=t.call,this.params=t.params||0,this.inputFormatter=t.inputFormatter,this.outputFormatter=t.outputFormatter,this.transformPayload=t.transformPayload,this.extraFormatters=t.extraFormatters,this.abiCoder=t.abiCoder,this.requestManager=t.requestManager,this.accounts=t.accounts,this.defaultBlock=t.defaultBlock||\"latest\",this.defaultAccount=t.defaultAccount||null,this.transactionBlockTimeout=t.transactionBlockTimeout||50,this.transactionConfirmationBlocks=t.transactionConfirmationBlocks||24,this.transactionPollingTimeout=t.transactionPollingTimeout||750,this.defaultCommon=t.defaultCommon,this.defaultChain=t.defaultChain,this.defaultHardfork=t.defaultHardfork,this.handleRevert=t.handleRevert};d.prototype.setRequestManager=function(t,e){this.requestManager=t,e&&(this.accounts=e)},d.prototype.createFunction=function(t,e){var r=this.buildCall();return r.call=this.call,this.setRequestManager(t||this.requestManager,e||this.accounts),r},d.prototype.attachToObject=function(t){var e=this.buildCall();e.call=this.call;var r=this.name.split(\".\");r.length>1?(t[r[0]]=t[r[0]]||{},t[r[0]][r[1]]=e):t[r[0]]=e},d.prototype.getCall=function(t){return\"function\"==typeof this.call?this.call(t):this.call},d.prototype.extractCallback=function(t){if(\"function\"==typeof t[t.length-1])return t.pop()},d.prototype.validateArgs=function(t){if(t.length!==this.params)throw u.InvalidNumberOfParams(t.length,this.params,this.name)},d.prototype.formatInput=function(t){var e=this;return this.inputFormatter?this.inputFormatter.map(function(r,a){return r?r.call(e,t[a]):t[a]}):t},d.prototype.formatOutput=function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.outputFormatter&&t?e.outputFormatter(t):t}):this.outputFormatter&&t?this.outputFormatter(t):t},d.prototype.toPayload=function(t){var e=this.getCall(t),r=this.extractCallback(t),a=this.formatInput(t);this.validateArgs(a);var n={method:e,params:a,callback:r};return this.transformPayload&&(n=this.transformPayload(n)),n},d.prototype._confirmTransaction=function(t,e,r){var a=this,n=!1,o=!0,i=0,v=0,b=null,g=null,y=r.params[0]&&\"object\"===c(r.params[0])&&r.params[0].gas?r.params[0].gas:null,k=!!r.params[0]&&\"object\"===c(r.params[0])&&r.params[0].data&&r.params[0].from&&!r.params[0].to,x=k&&r.params[0].data.length>2,F=[new d({name:\"getBlockByNumber\",call:\"eth_getBlockByNumber\",params:2,inputFormatter:[l.inputBlockNumberFormatter,function(t){return!!t}],outputFormatter:l.outputBlockFormatter}),new d({name:\"getTransactionReceipt\",call:\"eth_getTransactionReceipt\",params:1,inputFormatter:[null],outputFormatter:l.outputTransactionReceiptFormatter}),new d({name:\"getCode\",call:\"eth_getCode\",params:2,inputFormatter:[l.inputAddressFormatter,l.inputDefaultBlockNumberFormatter]}),new d({name:\"getTransactionByHash\",call:\"eth_getTransactionByHash\",params:1,inputFormatter:[null],outputFormatter:l.outputTransactionFormatter}),new p({name:\"subscribe\",type:\"eth\",subscriptions:{newBlockHeaders:{subscriptionName:\"newHeads\",params:0,outputFormatter:l.outputBlockFormatter}}})],w={};F.forEach(function(t){t.attachToObject(w),t.requestManager=a.requestManager});var E=function(c,p,d,F,E){if(!d)return E||(E={unsubscribe:function(){clearInterval(b)}}),(c?f.resolve(c):w.getTransactionReceipt(e)).catch(function(e){E.unsubscribe(),n=!0,m._fireError({message:\"Failed to check for transaction receipt:\",data:e},t.eventEmitter,t.reject)}).then(function(){var e=s(regeneratorRuntime.mark(function e(r){var n,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&r.blockHash){e.next=2;break}throw new Error(\"Receipt missing or blockHash null\");case 2:if(a.extraFormatters&&a.extraFormatters.receiptFormatter&&(r=a.extraFormatters.receiptFormatter(r)),!(t.eventEmitter.listeners(\"confirmation\").length>0)){e.next=28;break}if(void 0!==c&&0===v){e.next=25;break}return e.next=7,w.getBlockByNumber(\"latest\");case 7:if(i=e.sent,s=i?i.hash:null,!p){e.next=24;break}if(!g){e.next=17;break}return e.next=13,w.getBlockByNumber(g.number+1);case 13:(n=e.sent)&&(g=n,t.eventEmitter.emit(\"confirmation\",v,r,s)),e.next=22;break;case 17:return e.next=19,w.getBlockByNumber(r.blockNumber);case 19:n=e.sent,g=n,t.eventEmitter.emit(\"confirmation\",v,r,s);case 22:e.next=25;break;case 24:t.eventEmitter.emit(\"confirmation\",v,r,s);case 25:(p&&n||!p)&&v++,o=!1,v===a.transactionConfirmationBlocks+1&&(E.unsubscribe(),t.eventEmitter.removeAllListeners());case 28:return e.abrupt(\"return\",r);case 29:case\"end\":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=s(regeneratorRuntime.mark(function e(r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!k||n){e.next=19;break}if(r.contractAddress){e.next=5;break}return o&&(E.unsubscribe(),n=!0),m._fireError(u.NoContractAddressFoundError(r),t.eventEmitter,t.reject,null,r),e.abrupt(\"return\");case 5:return e.prev=5,e.next=8,w.getCode(r.contractAddress);case 8:i=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:if(i){e.next=15;break}return e.abrupt(\"return\");case 15:!0===r.status&&x||i.length>2?(t.eventEmitter.emit(\"receipt\",r),a.extraFormatters&&a.extraFormatters.contractDeployFormatter?t.resolve(a.extraFormatters.contractDeployFormatter(r)):t.resolve(r),o&&t.eventEmitter.removeAllListeners()):m._fireError(u.ContractCodeNotStoredError(r),t.eventEmitter,t.reject,null,r),o&&E.unsubscribe(),n=!0;case 19:return e.abrupt(\"return\",r);case 20:case\"end\":return e.stop()}},e,null,[[5,11]])}));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=s(regeneratorRuntime.mark(function e(i){var s,c,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k||n){e.next=35;break}if(i.outOfGas||y&&y===i.gasUsed||!0!==i.status&&\"0x1\"!==i.status&&void 0!==i.status){e.next=7;break}t.eventEmitter.emit(\"receipt\",i),t.resolve(i),o&&t.eventEmitter.removeAllListeners(),e.next=33;break;case 7:if(JSON.stringify(i,null,2),!1!==i.status&&\"0x0\"!==i.status){e.next=32;break}if(e.prev=9,s=null,!a.handleRevert||\"eth_sendTransaction\"!==a.call&&\"eth_sendRawTransaction\"!==a.call){e.next=24;break}return c=r.params[0],\"eth_sendRawTransaction\"===a.call&&(f=r.params[0],p=h.parse(f),c=l.inputTransactionFormatter({data:p.data,to:p.to,from:p.from,gas:p.gasLimit.toHexString(),gasPrice:p.gasPrice.toHexString(),value:p.value.toHexString()})),e.next=16,a.getRevertReason(c,i.blockNumber);case 16:if(!(s=e.sent)){e.next=21;break}m._fireError(u.TransactionRevertInstructionError(s.reason,s.signature,i),t.eventEmitter,t.reject,null,i),e.next=22;break;case 21:throw!1;case 22:e.next=25;break;case 24:throw!1;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(9),m._fireError(u.TransactionRevertedWithoutReasonError(i),t.eventEmitter,t.reject,null,i);case 30:e.next=33;break;case 32:m._fireError(u.TransactionOutOfGasError(i),t.eventEmitter,t.reject,null,i);case 33:o&&E.unsubscribe(),n=!0;case 35:case\"end\":return e.stop()}},e,null,[[9,27]])}));return function(t){return e.apply(this,arguments)}}()).catch(function(){i++,p?i-1>=a.transactionPollingTimeout&&(E.unsubscribe(),n=!0,m._fireError(u.TransactionError(\"Transaction was not mined within \"+a.transactionPollingTimeout+\" seconds, please make sure your transaction was properly sent. Be aware that it might still be mined!\"),t.eventEmitter,t.reject)):i-1>=a.transactionBlockTimeout&&(E.unsubscribe(),n=!0,m._fireError(u.TransactionError(\"Transaction was not mined within \"+a.transactionBlockTimeout+\" blocks, please make sure your transaction was properly sent. Be aware that it might still be mined!\"),t.eventEmitter,t.reject))});E.unsubscribe(),n=!0,m._fireError({message:\"Failed to subscribe to new newBlockHeaders to confirm the transaction receipts.\",data:d},t.eventEmitter,t.reject)},P=function(t){var e=function(){b=setInterval(E.bind(null,t,!0),1e3)};this.requestManager.provider.on?w.subscribe(\"newBlockHeaders\",function(r,a,n){r||!a?e():E(t,!1,r,0,n)}):e()}.bind(this);w.getTransactionReceipt(e).then(function(e){e&&e.blockHash?(t.eventEmitter.listeners(\"confirmation\").length>0&&P(e),E(e,!1)):n||P()}).catch(function(){n||P()})};var v=function(t,e){return\"number\"==typeof t?e.wallet[t]:t&&\"object\"===c(t)&&t.address&&t.privateKey?t:e.wallet[t.toLowerCase()]};function b(e,r){return new Promise(function(a,n){try{var o=new d({name:\"getBlockByNumber\",call:\"eth_getBlockByNumber\",params:2,inputFormatter:[function(t){return t?m.toHex(t):\"latest\"},function(){return!1}]}).createFunction(e.requestManager),i=new d({name:\"getGasPrice\",call:\"eth_gasPrice\",params:0}).createFunction(e.requestManager);Promise.all([o(),i()]).then(function(e){var n=t(e,2),o=n[0],i=n[1];if(o&&o.baseFeePerGas){var s,c;r.gasPrice?(s=r.gasPrice,c=r.gasPrice,delete r.gasPrice):(s=r.maxPriorityFeePerGas||\"0x3B9ACA00\",c=r.maxFeePerGas||m.toHex(m.toBN(o.baseFeePerGas).mul(m.toBN(2)).add(m.toBN(s)))),a({maxFeePerGas:c,maxPriorityFeePerGas:s})}else{if(r.maxPriorityFeePerGas||r.maxFeePerGas)throw Error(\"Network doesn't support eip-1559\");a({gasPrice:i})}})}catch(s){n(s)}})}d.prototype.buildCall=function(){var t=this,e=\"eth_sendTransaction\"===t.call||\"eth_sendRawTransaction\"===t.call,r=\"eth_call\"===t.call,a=function(){var a=f(!e),n=t.toPayload(Array.prototype.slice.call(arguments)),o=function(o,i){var s;if(t.handleRevert&&r&&t.abiCoder&&(!o&&t.isRevertReasonString(i)?s=i.substring(10):o&&o.data&&(s=o.data.substring(10)),s)){var c=t.abiCoder.decodeParameter(\"string\",\"0x\"+s);return void m._fireError(u.RevertInstructionError(c,\"Error(String)\"),a.eventEmitter,a.reject,n.callback,{reason:c,signature:\"Error(String)\"})}try{i=t.formatOutput(i)}catch(l){o=l}if(i instanceof Error&&(o=i),o)return o.error&&(o=o.error),m._fireError(o,a.eventEmitter,a.reject,n.callback);n.callback&&n.callback(null,i),e?(a.eventEmitter.emit(\"transactionHash\",i),t._confirmTransaction(a,i,n)):o||a.resolve(i)},i=function(e){var r={...n,method:\"eth_sendRawTransaction\",params:[e.rawTransaction]};t.requestManager.send(r,o)},s=function(t,e){var r;if(e&&e.accounts&&e.accounts.wallet&&e.accounts.wallet.length)if(\"eth_sendTransaction\"===t.method){var n=t.params[0];if((r=v(n&&\"object\"===c(n)?n.from:null,e.accounts))&&r.privateKey)return delete(n=JSON.parse(JSON.stringify(n))).from,e.defaultChain&&!n.chain&&(n.chain=e.defaultChain),e.defaultHardfork&&!n.hardfork&&(n.hardfork=e.defaultHardfork),e.defaultCommon&&!n.common&&(n.common=e.defaultCommon),void e.accounts.signTransaction(n,r.privateKey).then(i).catch(function(t){if(\"function\"==typeof a.eventEmitter.listeners&&a.eventEmitter.listeners(\"error\").length){try{a.eventEmitter.emit(\"error\",t)}catch(t){}a.eventEmitter.removeAllListeners(),a.eventEmitter.catch(function(){})}a.reject(t)})}else if(\"eth_sign\"===t.method){var s=t.params[1];if((r=v(t.params[0],e.accounts))&&r.privateKey){var u=e.accounts.sign(s,r.privateKey);return t.callback&&t.callback(null,u.signature),void a.resolve(u.signature)}}return e.requestManager.send(t,o)};return e&&n.params[0]&&\"object\"===c(n.params[0])&&void 0===n.params[0].gasPrice&&(void 0===n.params[0].maxPriorityFeePerGas||void 0===n.params[0].maxFeePerGas)?b(t,n.params[0]).then(function(r){void 0!==r.gasPrice?n.params[0].gasPrice=r.gasPrice:void 0!==r.maxPriorityFeePerGas&&void 0!==r.maxFeePerGas&&(n.params[0].maxPriorityFeePerGas=r.maxPriorityFeePerGas,n.params[0].maxFeePerGas=r.maxFeePerGas),e&&setTimeout(function(){a.eventEmitter.emit(\"sending\",n)},0),s(n,t)}):(e&&setTimeout(function(){a.eventEmitter.emit(\"sending\",n)},0),s(n,t)),e&&setTimeout(function(){a.eventEmitter.emit(\"sent\",n)},0),a.eventEmitter};return a.method=t,a.request=this.request.bind(this),a},d.prototype.getRevertReason=function(t,e){var r=this;return new Promise(function(a,n){new d({name:\"call\",call:\"eth_call\",params:2,abiCoder:r.abiCoder,handleRevert:!0}).createFunction(r.requestManager)(t,m.numberToHex(e)).then(function(){a(!1)}).catch(function(t){t.reason?a({reason:t.reason,signature:t.signature}):n(t)})})},d.prototype.isRevertReasonString=function(t){return\"string\"==typeof t&&(t.length-2)/2%32==4&&\"0x08c379a0\"===t.substring(0,10)},d.prototype.request=function(){var t=this.toPayload(Array.prototype.slice.call(arguments));return t.format=this.formatOutput.bind(this),t},module.exports=d;"},"sourceMaps":null,"error":null,"hash":"af14c7d2e2b1efaf4765b35a9c72db12","cacheData":{"env":{}}}