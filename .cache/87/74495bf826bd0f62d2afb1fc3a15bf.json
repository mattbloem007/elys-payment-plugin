{"id":"P0ah","dependencies":[{"name":"/Users/gabriel/Documents/paymentelys/package.json","includedInParent":true,"mtime":1630497371087},{"name":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/package.json","includedInParent":true,"mtime":1629877547117},{"name":"web3-core-helpers","loc":{"line":25,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/subscription.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-helpers/lib/index.js"},{"name":"eventemitter3","loc":{"line":24,"column":27},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/subscription.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/eventemitter3/index.js"}],"generated":{"js":"\"use strict\";function t(r){return(t=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(r)}var r=require(\"web3-core-helpers\").errors,o=require(\"eventemitter3\"),s=require(\"web3-core-helpers\").formatters;function i(t){return t}function e(t){o.call(this),this.id=null,this.callback=i,this.arguments=null,this.lastBlock=null,this.options={subscription:t.subscription,type:t.type,requestManager:t.requestManager}}e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype._extractCallback=function(t){if(\"function\"==typeof t[t.length-1])return t.pop()},e.prototype._validateArgs=function(t){var o=this.options.subscription;if(o||(o={}),o.params||(o.params=0),t.length!==o.params)throw r.InvalidNumberOfParams(t.length,o.params,o.subscriptionName)},e.prototype._formatInput=function(t){var r=this.options.subscription;return r&&r.inputFormatter?r.inputFormatter.map(function(r,o){return r?r(t[o]):t[o]}):t},e.prototype._formatOutput=function(t){var r=this.options.subscription;return r&&r.outputFormatter&&t?r.outputFormatter(t):t},e.prototype._toPayload=function(t){var r=[];if(this.callback=this._extractCallback(t)||i,this.subscriptionMethod||(this.subscriptionMethod=t.shift(),this.options.subscription.subscriptionName&&(this.subscriptionMethod=this.options.subscription.subscriptionName)),this.arguments||(this.arguments=this._formatInput(t),this._validateArgs(this.arguments),t=[]),r.push(this.subscriptionMethod),r=r.concat(this.arguments),t.length)throw new Error(\"Only a callback is allowed as parameter on an already instantiated subscription.\");return{method:this.options.type+\"_subscribe\",params:r}},e.prototype.unsubscribe=function(t){this.options.requestManager.removeSubscription(this.id,t),this.id=null,this.lastBlock=null,this.removeAllListeners()},e.prototype.subscribe=function(){var r=this,o=Array.prototype.slice.call(arguments),i=this._toPayload(o);if(!i)return this;if(!this.options.requestManager.provider)return setTimeout(function(){var t=new Error(\"No provider set.\");r.callback(t,null,r),r.emit(\"error\",t)},0),this;if(!this.options.requestManager.provider.on)return setTimeout(function(){var t=new Error(\"The current provider doesn't support subscriptions: \"+r.options.requestManager.provider.constructor.name);r.callback(t,null,r),r.emit(\"error\",t)},0),this;if(this.lastBlock&&this.options.params&&\"object\"===t(this.options.params)&&(i.params[1]=this.options.params,i.params[1].fromBlock=s.inputBlockNumberFormatter(this.lastBlock+1)),this.id&&this.unsubscribe(),this.options.params=i.params[1],\"logs\"===i.params[0]&&i.params[1]&&\"object\"===t(i.params[1])&&i.params[1].hasOwnProperty(\"fromBlock\")&&isFinite(i.params[1].fromBlock)){var e=Object.assign({},i.params[1]);this.options.requestManager.send({method:\"eth_getLogs\",params:[e]},function(t,o){t?setTimeout(function(){r.callback(t,null,r),r.emit(\"error\",t)},0):o.forEach(function(t){var o=r._formatOutput(t);r.callback(null,o,r),r.emit(\"data\",o)})})}return\"object\"===t(i.params[1])&&delete i.params[1].fromBlock,this.options.requestManager.send(i,function(o,s){!o&&s?(r.id=s,r.method=i.params[0],r.emit(\"connected\",s),r.options.requestManager.addSubscription(r,function(o,s){o?(r.callback(o,!1,r),r.emit(\"error\",o)):(Array.isArray(s)||(s=[s]),s.forEach(function(o){var s=r._formatOutput(o);if(r.lastBlock=s&&\"object\"===t(s)?s.blockNumber:null,\"function\"==typeof r.options.subscription.subscriptionHandler)return r.options.subscription.subscriptionHandler.call(r,s);r.emit(\"data\",s),r.callback(null,s,r)}))})):setTimeout(function(){r.callback(o,!1,r),r.emit(\"error\",o)},0)}),this},e.prototype.resubscribe=function(){this.options.requestManager.removeSubscription(this.id),this.id=null,this.subscribe(this.callback)},module.exports=e;"},"sourceMaps":null,"error":null,"hash":"dcae9dffa5207f513b56a9314f57bca0","cacheData":{"env":{}}}