{"id":"P0ah","dependencies":[{"name":"/Users/gabriel/Documents/paymentelys/package.json","includedInParent":true,"mtime":1630498634517},{"name":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/package.json","includedInParent":true,"mtime":1629877547117},{"name":"web3-core-helpers","loc":{"line":25,"column":25},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/subscription.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-helpers/lib/index.js"},{"name":"eventemitter3","loc":{"line":24,"column":27},"parent":"/Users/gabriel/Documents/paymentelys/node_modules/web3-core-subscriptions/lib/subscription.js","resolved":"/Users/gabriel/Documents/paymentelys/node_modules/eventemitter3/index.js"}],"generated":{"js":"\"use strict\";var t=require(\"web3-core-helpers\").errors,r=require(\"eventemitter3\"),s=require(\"web3-core-helpers\").formatters;function o(t){return t}function i(t){r.call(this),this.id=null,this.callback=o,this.arguments=null,this.lastBlock=null,this.options={subscription:t.subscription,type:t.type,requestManager:t.requestManager}}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype._extractCallback=function(t){if(\"function\"==typeof t[t.length-1])return t.pop()},i.prototype._validateArgs=function(r){var s=this.options.subscription;if(s||(s={}),s.params||(s.params=0),r.length!==s.params)throw t.InvalidNumberOfParams(r.length,s.params,s.subscriptionName)},i.prototype._formatInput=function(t){var r=this.options.subscription;return r&&r.inputFormatter?r.inputFormatter.map(function(r,s){return r?r(t[s]):t[s]}):t},i.prototype._formatOutput=function(t){var r=this.options.subscription;return r&&r.outputFormatter&&t?r.outputFormatter(t):t},i.prototype._toPayload=function(t){var r=[];if(this.callback=this._extractCallback(t)||o,this.subscriptionMethod||(this.subscriptionMethod=t.shift(),this.options.subscription.subscriptionName&&(this.subscriptionMethod=this.options.subscription.subscriptionName)),this.arguments||(this.arguments=this._formatInput(t),this._validateArgs(this.arguments),t=[]),r.push(this.subscriptionMethod),r=r.concat(this.arguments),t.length)throw new Error(\"Only a callback is allowed as parameter on an already instantiated subscription.\");return{method:this.options.type+\"_subscribe\",params:r}},i.prototype.unsubscribe=function(t){this.options.requestManager.removeSubscription(this.id,t),this.id=null,this.lastBlock=null,this.removeAllListeners()},i.prototype.subscribe=function(){var t=this,r=Array.prototype.slice.call(arguments),o=this._toPayload(r);if(!o)return this;if(!this.options.requestManager.provider)return setTimeout(function(){var r=new Error(\"No provider set.\");t.callback(r,null,t),t.emit(\"error\",r)},0),this;if(!this.options.requestManager.provider.on)return setTimeout(function(){var r=new Error(\"The current provider doesn't support subscriptions: \"+t.options.requestManager.provider.constructor.name);t.callback(r,null,t),t.emit(\"error\",r)},0),this;if(this.lastBlock&&this.options.params&&\"object\"==typeof this.options.params&&(o.params[1]=this.options.params,o.params[1].fromBlock=s.inputBlockNumberFormatter(this.lastBlock+1)),this.id&&this.unsubscribe(),this.options.params=o.params[1],\"logs\"===o.params[0]&&o.params[1]&&\"object\"==typeof o.params[1]&&o.params[1].hasOwnProperty(\"fromBlock\")&&isFinite(o.params[1].fromBlock)){var i=Object.assign({},o.params[1]);this.options.requestManager.send({method:\"eth_getLogs\",params:[i]},function(r,s){r?setTimeout(function(){t.callback(r,null,t),t.emit(\"error\",r)},0):s.forEach(function(r){var s=t._formatOutput(r);t.callback(null,s,t),t.emit(\"data\",s)})})}return\"object\"==typeof o.params[1]&&delete o.params[1].fromBlock,this.options.requestManager.send(o,function(r,s){!r&&s?(t.id=s,t.method=o.params[0],t.emit(\"connected\",s),t.options.requestManager.addSubscription(t,function(r,s){r?(t.callback(r,!1,t),t.emit(\"error\",r)):(Array.isArray(s)||(s=[s]),s.forEach(function(r){var s=t._formatOutput(r);if(t.lastBlock=s&&\"object\"==typeof s?s.blockNumber:null,\"function\"==typeof t.options.subscription.subscriptionHandler)return t.options.subscription.subscriptionHandler.call(t,s);t.emit(\"data\",s),t.callback(null,s,t)}))})):setTimeout(function(){t.callback(r,!1,t),t.emit(\"error\",r)},0)}),this},i.prototype.resubscribe=function(){this.options.requestManager.removeSubscription(this.id),this.id=null,this.subscribe(this.callback)},module.exports=i;"},"sourceMaps":null,"error":null,"hash":"351e426193204182f8eea18e0fdeb8a0","cacheData":{"env":{}}}